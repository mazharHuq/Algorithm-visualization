<!DOCTYPE html>
<html>
  <head>
    <title>Graph Test</title>
    <script
      type="text/javascript"
      src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"
    ></script>

    <style type="text/css">
      #container {
        margin: 0 auto;
        width: 80%;
        height: 600px;
        border: 1px solid lightgray;
        border-radius: 6px;
      }
    </style>
    <link rel="stylesheet" href="/CSS/sort.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Baloo+2&display=swap");

      body {
        font-family: "IBM Plex Mono", monospace;
      }
    </style>
    <style>
      #grid {
        border: 1px solid rgb(24, 179, 114);

        display: grid;
      }

      .cell {
        border: 1px solid #e6eff6;
        text-align: center;
        align-items: center;
        justify-content: center;
      }

      .control {
        padding: 10px;
        background: #afd8f8;
        border: 1px solid #afd8f8;
        text-align: center;
        align-items: center;
        justify-content: center;
        box-shadow: 1px 1px 1px 1px #afd8f8;
      }

      #editor {
        min-height: 400px;
        min-width: 100%;
      }
    </style>
    <link
      href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900|Raleway:100,300,400,600,700"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css"
      integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>

  <body>
    <nav class="shadow bg-white">
      <div class="mx-auto container">
        <div class="flex justify-between items-center px-4 py-2">
          <div class="flex items-center">
            <a href="../index.html">
              <h1 class="font-bold text-2xl ml-2">VisualAlgorithm</h1>
            </a>
          </div>
          <div class="flex items-center space-x-2">
            <div class="font-bold text-lg">
              <label>Select Algorithm</label>
              <select
                id="selectAlgorithm"
                class="bg-white border border-gray-400 rounded-lg shadow-md px-4 py-2"
              >
                <option value="">Select An Algorithm</option>
                <option value="bfs">Breadth-first search</option>
                <option value="dfs">Depth-first search</option>
                <option value="dijkstra">Dijkstra</option>
              </select>
            </div>
            <input
              type="text"
              id="startNode"
              value="Source"
              class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg"
            />
            <input
              type="text"
              id="startNode"
              value="Destination"
              class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg"
            />
            <button
              id="start"
              class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg"
            >
              Visualize
            </button>
          </div>
        </div>
      </div>
    </nav>
    <div class="shadow grid grid-cols-12 space-x-2">
      <div class="col-span-2" style="margin-left: 100px">
        <!-- Take Graph  Input and generate from Here -->
        Graph Data
        <div
          class="bg-white border border-gray-400 rounded-lg shadow-md px-4 py-2"
        >
          <div id="editor"></div>
        </div>
      </div>
      <div class="col-span-10">
        <div id="container"></div>
      </div>
    </div>

    <div style="" class="mediaControl shadow bg-white bottom-0 w-full">
      <div class="container flex justify-center mx-auto">
        <div class="flex items-center px-4 py-2">
          <div class="flex items-center space-x-8">
            <button class="">
              <i class="fa-solid fa-backward-step fa-2x"></i>
            </button>
            <button id="sortArray" class="">
              <i class="fa-solid fa-circle-play fa-2x"></i>
            </button>
            <button id="sortArrayPause" class="hidden">
              <i class="fa-solid fa-circle-pause fa-2x"></i>
            </button>

            <button class="">
              <i class="fa-solid fa-forward-step fa-2x"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Algorithm Details -->
    <div class="details shadow bg-white p-4 mx-auto">
      <div class="intro-y px-4 my-3 bg-green-500 py-4 text-3xl font-bold">
        <h2 id="algorithm-title">Bubble Sort</h2>
      </div>
      <div class="grid grid-cols-12 space-x-2">
        <div class="col-span-8 bg-gray-100">
          <div class="intro-y px-4 my-3 py-4 text-xl font-bold">
            <h2>Algorithm</h2>
            <p class="text-sm" id="algorithm-summary"></p>
          </div>
          <div class="intro-y px-4 my-3 py-4 text-xl font-medium">
            <h2>Description</h2>
            <p class="text-sm font-thin" id="algorithm-description"></p>
          </div>
        </div>
        <div class="col-span-4 bg-gray-100">
          <div class="intro-y text-2xl font-bold p-3 border-b">
            <h2>Performance</h2>
          </div>
          <div class="intro-y px-4 my-3 py-4 text-xl font-bold">
            <h2>Time Complexity</h2>
            <h4 class="text-sm" id="worstCase">
              Worst Case : O(n <sup>2</sup>)
            </h4>
            <h4 class="text-sm" id="averageCase">
              Average Case : O(n <sup>2</sup>)
            </h4>
            <h4 class="text-sm" id="bestCase">Best Case : O(n <sup>2</sup>)</h4>
          </div>
          <div class="intro-y px-4 my-3 py-4 text-xl">
            <h2>Space Complexity</h2>
            <h4 class="text-sm" id="spaceComplexity">
              Worst Case : O(n <sup>2</sup>)
            </h4>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://code.jquery.com/jquery-3.6.0.js"
      integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
      crossorigin="anonymous"
    ></script>
    <script type="text/javascript" src="./js/grid.js"></script>
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.9.6/ace.js"
      integrity="sha512-czfWedq9cnMibaqVP2Sw5Aw1PTTabHxMuTOkYkL15cbCYiatPIbxdV0zwhfBZKNODg0zFqmbz8f7rKmd6tfR/Q=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      type="text/javascript"
      src="../graph/js/graphAlgorithmDetails.js"
    ></script>
    <script type="text/javascript" src="../js/priorityQueue.js"></script>
    <script type="text/javascript" src="../js/buildGraph.js"></script>
    <script type="text/javascript" src="../js/visualizeGraphAlog.js"></script>
    <script type="text/javascript">
      let grid = {};

      let graphInfob = {
        edgeColor: "#548694",
        isDirected: true,
        isWeighted: true,
      };

      var options = {
        clickToUse: true,
        physics: { enabled: false },
        edges: {
          color: { inherit: false },
        },
        nodes: {
          color: "#93b7f9",
        },
        layout: {
          hierarchical: {
            enabled: false,
          },
        },
      };

      grid["1"] = [
        [2, 10],
        [3, 5],
      ];
      grid["2"] = [
        [4, 3],
        [5, 3],
      ];
      grid["3"] = [[4, 2]];
      grid["4"] = [[5, 2]];

      var graph = new buildGraph(graphInfob, grid);
      //var steps = graph.getWeightedDijkstraSteps(1, 5);

      var steps = graph.getUnWeightedDfsSteps(1, 5);

      //var steps = graph.getWeightedBFS(1, 5);

      var container = document.getElementById("container");
      let visDfs = new visualizeGraphAlog(steps, "#FF0AB1", "#548694", true);
      visDfs.init(container, graph.getGraph(), options);

      var editor = ace.edit("editor");
      editor.setTheme("ace/theme/light");
      //   editor.session.setMode("ace/mode/algorithm");
      document.getElementById("editor").style.fontSize = "19px";
      editor.setOptions({
        enableBasicAutocompletion: true,
        enableLiveAutocompletion: true,
      });

      function dbg(value) {
        console.log(value); // eslint-disable-line no-console
      }

      editor.on("change", function (delta) {
        //get value type
        let value = editor.getValue();

        if (value.length == undefined) {
        } else if (value.length > 0) {
          value = value.replaceAll(" ", ",");
          var newValue = "";
          for (var i = 0; i < value.length; i++) {
            if (i == 0 && value[i] == ",") continue;
            if (value[i - 1] == "," && value[i] == ",") continue;
            newValue += value[i];
          }
          if (newValue.length && newValue[newValue.length - 1] == ",") {
            newValue = newValue.substring(0, newValue.length - 1);
          }
          var valueType = newValue.split(/\r?\n/);
          extactedData = valueType;

          let gridData = {};

          for (let i = 0; i < extactedData.length; i++) {
            if (extactedData[i].length == 0) continue;
            extactedData[i] = extactedData[i].replaceAll(",", " ");
            extactedData[i] = extactedData[i].trim();
            let row = extactedData[i].split(" ");
            dbg(row);
            gridData[row[0]] = [];
            let lim = row.length > 2 ? 2 : row.length;
            for (let j = 0; j < lim; j++) {
              gridData[row[j]] = [];
            }
          }

          let map = [];
          for (let i = 0; i < extactedData.length; i++) {
            if (extactedData[i].length == 0) continue;
            let row = extactedData[i].split(" ");
            if (row.length == 0) continue;
            if (row.length === 1) continue;
            else if (row.length === 2) {
              let key = [row[0], row[1]];
              if (map[key] == undefined) {
                map[key] = 1;
                gridData[row[0]].push([row[1], 0]);
              } else {
                for (let j = 0; j < gridData[row[0]].length; j++) {
                  if (gridData[row[0]][j][0] == row[1]) {
                    //gridData[row[0]][j][1] = 0;
                  }
                }
              }
              //gridData[row[0]].push([row[1], 0]);
            } else {
              let key = [row[0], row[1]];
              if (map[key] == undefined) {
                map[key] = 1;
                gridData[row[0]].push([row[1], row[2]]);
              } else {
                for (let j = 0; j < gridData[row[0]].length; j++) {
                  if (gridData[row[0]][j][0] == row[1]) {
                    gridData[row[0]][j][1] = row[2];
                  }
                }
              }
              //gridData[row[0]].push([row[1], row[2]]);
            }
          }

          grid = gridData;
          dbg(grid);
          graph.setGrid(grid);
          visDfs.init(container, graph.getGraph(), options);
        }
      });

      $("#start").click(function () {
        //select start node and end node and calling method;
        var start = $("#startNode").val();
        var end = $("#endNode").val();
        var steps = graph.getUnWeightedBfsSteps(start, end);
        visDfs.init(container, graph.getGraph(), options);
      });

      $("#selectAlgorithm").on("change", function () {
        let algorithm = $(this).val();
        let selectedAlgorithm = new graphAlgorithmDetails(algorithm);
        $("#algorithm-title").html(selectedAlgorithm.algorithmName);
        $("#algorithm-summary").html(selectedAlgorithm.algorithmSummary);
        $("#algorithm-description").html(
          selectedAlgorithm.algorithmDescription
        );
        $("#worstCase").html(selectedAlgorithm.bestTime);
        $("#averageCase").html(selectedAlgorithm.averageTime);
        $("#bestCase").html(selectedAlgorithm.worstTime);
        $("#spaceComplexity").html(selectedAlgorithm.spaceComplexity);
      });
      /*
    let isFirstStep = true;

    function startAnimation() {
      if (!isFirstStep) {
        visDfs.releaseStep();
      }

      if (!visDfs.isStepAvailable()) {
        clearInt();
        return;
      }

      visDfs.nextStep();
      isFirstStep = false;
    }

    const myInt = setInterval(startAnimation, 2000);

    function clearInt() {
      clearInterval(myInt);
    }
    */
    </script>
  </body>
</html>
